{"version":3,"file":"exception.js","sourceRoot":"","sources":["../../src/middlewares/exception.ts"],"names":[],"mappings":";;;;AAAA,yCAA2F;AAC3F,iDAAkE;AAClE,kDAA2E;AAC3E,yCAA0C;AAG1C,IAAa,SAAS,GAAtB,MAAa,SAAU,SAAQ,qCAA4B;IACzD,GAAG,CAAQ,KAAU,EAAS,OAAY,EAAS,QAAa;QAC9D,IAAI,KAAK,YAAY,sBAAK,EAAE;YAC1B,OAAO,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,wBAAa,CAAC,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;SACrH;QACD,IAAI,KAAK,YAAY,2BAAe,EAAE;YACpC,OAAO,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,kCAAuB,CAAC,KAAK,CAAC,CAAC,CAAC;SAClE;QAED,OAAO,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IAC7C,CAAC;CACF,CAAA;AAVC;IAAK,mBAAA,YAAG,EAAE,CAAA,EAAc,mBAAA,YAAG,EAAE,CAAA,EAAgB,mBAAA,YAAG,EAAE,CAAA;;;;oCASjD;AAVU,SAAS;IADrB,yBAAgB,CAAC,qCAA4B,CAAC;GAClC,SAAS,CAWrB;AAXY,8BAAS","sourcesContent":["import {Err, GlobalErrorHandlerMiddleware, OverrideProvider, Req, Res} from \"@tsed/common\";\nimport {Exception as Error, Unauthorized} from \"@tsed/exceptions\";\nimport {errorValidationResponse, errorResponse} from \"../helpers/response\";\nimport {ValidationError} from \"sequelize\";\n\n@OverrideProvider(GlobalErrorHandlerMiddleware)\nexport class Exception extends GlobalErrorHandlerMiddleware {\n  use(@Err() error: any, @Req() request: Req, @Res() response: Res): any {\n    if (error instanceof Error) {\n      return response.status(error.status).json(errorResponse(error.message, error.body ? error.body : {}, error.status));\n    }\n    if (error instanceof ValidationError) {\n      return response.status(422).json(errorValidationResponse(error));\n    }\n\n    return super.use(error, request, response);\n  }\n}\n"]}